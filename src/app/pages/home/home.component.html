<!-- Navbar -->
<nav class="navbar">
  <div class="logo">OLX KZ</div>

  <div class="links">
    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏ -->
    <button (click)="showForm = true" *ngIf="isLoggedIn" class="post-btn modern-btn">–ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>

    <!-- –ú–æ–¥–∞–ª–∫–∞ -->
    <div class="modal-backdrop" *ngIf="showForm">
      <div class="modal-window animate-scaleIn">
        <!-- –ó–∞–∫—Ä—ã—Ç—å -->
        <button class="modal-close" (click)="closeForm()">&times;</button>

        <h2 class="modal-title">
          {{ editMode ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä' : '–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä' }}
        </h2>

        <form (ngSubmit)="editMode ? updateProduct() : submitProduct()" #productForm="ngForm">
          <input type="text" name="title" [(ngModel)]="newProduct.title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" required />
          
          <textarea name="description" [(ngModel)]="newProduct.description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" rows="3" required></textarea>
          
          <input type="number" name="price" [(ngModel)]="newProduct.price" placeholder="–¶–µ–Ω–∞ –≤ ‚Ç∏" required />
          
          <select name="category" [(ngModel)]="newProduct.category" required>
            <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
            <option *ngFor="let category of categories" [value]="category._id">{{ category.name }}</option>
          </select>
          <div *ngIf="errorMessage" class="error-msg">
            {{ errorMessage }}
          </div>


          <div class="form-actions">
            <button type="submit" class="btn-submit">
              {{ editMode ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å' }}
            </button>
            <button type="button" class="btn-cancel" (click)="closeForm()">–û—Ç–º–µ–Ω–∞</button>
          </div>
        </form>
      </div>
    </div>

    <!-- –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω -->
    <ng-container *ngIf="!isLoggedIn">
      <a routerLink="/login">–í–æ–π—Ç–∏</a>
    </ng-container>

    <!-- –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω -->
    <ng-container *ngIf="isLoggedIn">
      <div class="profile-menu" (click)="toggleDropdown()" tabindex="0" (blur)="hideDropdown()">
        <img src="https://i1.sndcdn.com/avatars-4CyQHzjhyL68JW5K-iYFVDw-t1080x1080.jpg" alt="Avatar" class="avatar" />
        <span>{{ currentUser.username }}</span>

        <div class="dropdown" *ngIf="showDropdown">
          <button (click)="logout()">–í—ã–π—Ç–∏</button>
        </div>
      </div>
    </ng-container>
  </div>
</nav>

<section class="search-section">
  <div class="search-box">
    <input type="text" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∏–º–µ–Ω–∏..." [(ngModel)]="searchTerm"/>
    <button (click)="searchProducts()">–ò—Å–∫–∞—Ç—å</button>
    <button (click)="resetFilter()" class="bt2">–û—Ç–º–µ–Ω–∏—Ç—å</button>
  </div>

</section>

<!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<section class="categories">
  <h3 class="fw-bold">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
  <div class="category-list">
    <div class="category" *ngFor="let cat of categories" (click)="filterByCategory(cat._id)">
      <a class="category-card">
        <img src='https://www.milroystuxedos.com/content/images/thumbs/default-image_450.png' alt="{{ cat.name }}">
        <p>{{ cat.name }}</p>
      </a>
    </div>
    <!-- <button (click)="resetFilter()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</button> -->
  </div>
  
</section>

<!-- –ë–∞–Ω–Ω–µ—Ä -->
<!-- <section class="banner">
  <img src="https://mydukaan.io/blog/wp-content/uploads/Frame-1.png" alt="–°–∫–∏–¥–∫–∏" class="banner-image" />
</section> -->

<!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
<section class="filter-bar" style="display: flex; align-items: center; padding: 0 1rem; margin-bottom: 1rem;">
  <h3 class="fw-bold">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</h3>

  <div style="display: flex; align-items: center; gap: 0.5rem;">
    <label for="sortSelect" class="fw-bold">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ü–µ–Ω–µ:</label>
    <select id="sortSelect" [(ngModel)]="sortOrder" (change)="sortProducts()">
      <option value="none">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
      <option value="asc">–°–Ω–∞—á–∞–ª–∞ –¥–µ—à–µ–≤—ã–µ</option>
      <option value="desc">–°–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–≥–∏–µ</option>
    </select>
  </div>
</section>

<!-- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
<section class="product-grid">
  <div class="product" *ngFor="let product of filteredProducts">
    <img
      src="https://upload.wikimedia.org/wikipedia/commons/1/14/No_Image_Available.jpg"
      alt="{{ product.title }}"
      class="product-image"
      [routerLink]="['/product', product._id]"
    />
    <h4>{{ product.title }}</h4>
    <p>{{ product.price }} ‚Ç∏</p>
    <div *ngIf="isMyProduct(product)" class="btns">
      <button (click)="deleteProduct(product._id)" class="btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
      <button (click)="editProduct(product)" class="btn-warning">–û–±–Ω–æ–≤–∏—Ç—å</button>
    </div>
  </div>
</section>

<footer class="footer-container">
  <div class="footer-logo">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRE42TE9vxpwWvB_abpGkBzFyesMOsYxil7lF9m6xuG16dysQ23l9kyeZx6mykiTbCYj2k&usqp=CAU" alt="OLX Logo" class="olx-logo" />
  </div>

  <div class="footer-text">
    <p class="footer-title">–ö—Ä—É–ø–Ω–µ–π—à–∏–π –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</p>
    <p>
      –í—Å–µ –æ–Ω–ª–∞–π–Ω-–æ–±—ä—è–≤–ª–µ–Ω–∏—è –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ –Ω–∞ OLX ‚Äì –∑–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ —Ç–æ, —á—Ç–æ –∏—Å–∫–∞–ª–∏! –ù–∞–∂–∞–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ", –≤—ã —Å–º–æ–∂–µ—Ç–µ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ª—é–±—É—é —Ç–µ–º–∞—Ç–∏–∫—É –ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ.
    </p>
    <p>
      –° –ø–æ–º–æ—â—å—é —Å–µ—Ä–≤–∏—Å–∞ OLX –≤—ã —Å–º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–∞—Ç—å –∏–∑ —Ä—É–∫ –≤ —Ä—É–∫–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ, —á—Ç–æ —É–≥–æ–¥–Ω–æ.
    </p>
  </div>

  <div class="footer-socials">
    <p>–°–æ–æ–±—â–µ—Å—Ç–≤–∞ OLX.kz –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö:</p>
    <div class="icons">
      <a href="#"><i class="fab fa-facebook fa-2x"></i></a>
      <a href="#"><i class="fab fa-instagram fa-2x"></i></a>
      <a href="#"><i class="fab fa-youtube fa-2x"></i></a>
    </div>
  </div>
</footer>
